<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bestride Admin Panel</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    input, button { padding: 6px; margin: 4px 0; width: 100%; max-width: 400px; }
    #map { height: 400px; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Bestride Admin Panel</h1>

  <h2>Reservations</h2>
  <table id="reservationsTable">
    <thead>
      <tr>
        <th>Name</th>
        <th>Origin</th>
        <th>Destination</th>
        <th>Phone</th>
        <th>Date</th>
        <th>Time</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>Add Test Reservation</h2>
  <form id="adminForm">
    <input type="text" id="adminName" placeholder="Your name" required>
    <input type="text" id="adminOrigin" placeholder="Origin" required>
    <input type="text" id="adminDestination" placeholder="Destination" required>
    <input type="tel" id="adminPhone" placeholder="+1XXXXXXXXXX" required>
    <input type="date" id="adminDate" required>
    <input type="time" id="adminTime" required>
    <button type="submit">Add Reservation</button>
  </form>

  <div id="map"></div>

  <script>
    let map;
    let marker;
    let originAutocomplete, destinationAutocomplete;

    const reservations = [];

    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: { lat: 35.2271, lng: -80.8431 },
        zoom: 10
      });

      originAutocomplete = new google.maps.places.Autocomplete(document.getElementById('adminOrigin'));
      destinationAutocomplete = new google.maps.places.Autocomplete(document.getElementById('adminDestination'));
    }

    function addReservationToTable(res) {
      const tbody = document.querySelector('#reservationsTable tbody');
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${res.name}</td>
        <td>${res.origin}</td>
        <td>${res.destination}</td>
        <td>${res.phone}</td>
        <td>${res.date}</td>
        <td>${res.time}</td>
      `;
      tbody.appendChild(row);
    }

    document.getElementById('adminForm').addEventListener('submit', e => {
      e.preventDefault();
      const reservation = {
        name: document.getElementById('adminName').value,
        origin: document.getElementById('adminOrigin').value,
        destination: document.getElementById('adminDestination').value,
        phone: document.getElementById('adminPhone').value,
        date: document.getElementById('adminDate').value,
        time: document.getElementById('adminTime').value
      };
      reservations.push(reservation);
      addReservationToTable(reservation);

      // Center map on origin
      const geocoder = new google.maps.Geocoder();
      geocoder.geocode({ address: reservation.origin }, (results, status) => {
        if (status === "OK") {
          if (marker) marker.setMap(null);
          marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location,
            title: reservation.origin
          });
          map.setCenter(results[0].geometry.location);
          map.setZoom(12);
        }
      });

      e.target.reset();
    });

    window.initMap = initMap;
  </script>

  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDLW2JAH7IrHRloCFfaFTr1JB3DzsFPpDU&libraries=places&callback=initMap">
  </script>
</body>
</html>
